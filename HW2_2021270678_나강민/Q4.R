##################################
## 확률과 통계 과제             ##
## 고려대학교                   ##
## 서민석                       ##
## 2021270678 나강민 질문4      ##
##################################

## 라이브러리 및 저장소 설정
setRepositories(ind = 1:7)

# 패키지 설치
# install.packages("BSDA")

## 라이브러리 불러오기
library(devtools)
library(BSDA)

# 데이터 불러오기
data <- read.table("/Users/mac_nkm/Documents/GitHub/Probability_Statistics_KUS/HomeWork2/Data.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE) 

# 남성의 데이터 분리
data_male <- subset(data, Gender == "1")  

# z-test 수행
mu0 <- 74.62  # 국립보건원에서 정한 남성의 심박수 평균
sigma <- sqrt(11.1)  # 국립보건원에서 정한 남성의 심박수 표준편차 (분산의 제곱근을 취해줍니다.)
n <- nrow(data_male)  # 남성의 수
xbar <- mean(data_male$HR)  # 남성들의 심박수 평균
se <- sigma / sqrt(n)  # 표준 오차
z <- (xbar - mu0) / se  # 검정 통계량 계산

# p-value 계산
p_value_higher <- pnorm(-z)  # "남성의 심박수가 평균보다 높다"를 검정
p_value_lower <- pnorm(z)  # "남성의 심박수가 평균보다 낮다"를 검정
p_value_different <- 2 * pnorm(-abs(z))  # "남성의 심박수가 평균과 다르다"를 검정

# 결과 출력
cat("검정 통계량:", z, "
")
cat("p-value (higher):", p_value_higher, "
")
cat("p-value (lower):", p_value_lower, "
")
cat("p-value (different):", p_value_different, "
")

# 10% 유의 수준에서 의사결정
if (p_value_higher < 0.10) {
  cat("10%의 유의 수준에서, '남성의 심박수가 평균보다 높다'는 가설을 지지합니다.
")
} 
if (p_value_lower < 0.10) {
  cat("10%의 유의 수준에서, '남성의 심박수가 평균보다 낮다'는 가설을 지지합니다.
")
} 
if (p_value_different < 0.10) {
  cat("10%의 유의 수준에서, '남성의 심박수가 평균과 다르다'는 가설을 지지합니다.
")
}

############ 해당 코드 설명 ###################

# 유의 수준을 5%에서 10%로 높였을 때, 가설 검정의 결과는 어떻게 바뀌는지 살펴보겠습니다:
  
# '남성의 심박수가 평균보다 높다'는 가설은 5%의 유의 수준에서도 지지되었으므로, 10%에서도 지지됩니다.
# '남성의 심박수가 평균보다 낮다'는 가설은 5%와 10%의 유의 수준에서 모두 지지되지 않습니다.
# '남성의 심박수가 평균과 다르다'는 가설은 5%의 유의 수준에서는 지지되지 않았지만, 10%의 유의 수준에서는 지지됩니다.
# 이로부터 우리는 두 가지 주요한 점을 배울 수 있습니다:
  
# 유의 수준을 높이면 귀무 가설을 기각하기 쉬워집니다. 이는 유의 수준이 우리가 귀무 가설을 잘못 기각하는 오류를 감수할 확률을 결정하기 때문입니다. 유의 수준을 높일수록 이런 오류를 더 많이 감수하게 되므로, 귀무 가설을 기각하기 쉬워집니다.
# 가설 검정의 결과는 사용하는 유의 수준에 따라 달라질 수 있습니다. 따라서, 가설 검정을 수행할 때는 사용하는 유의 수준을 항상 명시해야 합니다.
# 이에 따라, 통계적 가설 검정은 단순히 p-value가 0.05보다 작은지를 보는 것만으로는 충분하지 않습니다. 분석의 목적과 문맥, 그리고 우리가 감수할 수 있는 오류의 정도를 고려하여 적절한 유의 수준을 선택해야 합니다.


