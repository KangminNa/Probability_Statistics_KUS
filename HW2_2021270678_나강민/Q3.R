##################################
## 확률과 통계 과제             ##
## 고려대학교                   ##
## 서민석                       ##
## 2021270678 나강민 질문3      ##
##################################

## 라이브러리 및 저장소 설정
setRepositories(ind = 1:7)

# 패키지 설치
# install.packages("BSDA")

## 라이브러리 불러오기
library(devtools)
library(BSDA)

# 데이터 불러오기
data <- read.table("/Users/mac_nkm/Documents/GitHub/Probability_Statistics_KUS/HomeWork2/Data.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE) 

# 남성의 데이터 분리
data_male <- subset(data, Gender == "1")  

# z-test 수행
mu0 <- 74.62  # 국립보건원에서 정한 남성의 심박수 평균
sigma <- sqrt(11.1)  # 국립보건원에서 정한 남성의 심박수 표준편차 (분산의 제곱근을 취해줍니다.)
n <- nrow(data_male)  # 남성의 수
xbar <- mean(data_male$HR)  # 남성들의 심박수 평균
se <- sigma / sqrt(n)  # 표준 오차
z <- (xbar - mu0) / se  # 검정 통계량 계산

# p-value 계산
p_value_higher <- pnorm(-z)  # "남성의 심박수가 평균보다 높다"를 검정
p_value_lower <- pnorm(z)  # "남성의 심박수가 평균보다 낮다"를 검정
p_value_different <- 2 * pnorm(-abs(z))  # "남성의 심박수가 평균과 다르다"를 검정

# 결과 출력
cat("검정 통계량:", z, "
")
cat("p-value (higher):", p_value_higher, "
")
cat("p-value (lower):", p_value_lower, "
")
cat("p-value (different):", p_value_different, "
")

# 5% 유의 수준에서 의사결정
if (p_value_higher < 0.05) {
  cat("5%의 유의 수준에서, '남성의 심박수가 평균보다 높다'는 가설을 지지합니다.
")
} 
if (p_value_lower < 0.05) {
  cat("5%의 유의 수준에서, '남성의 심박수가 평균보다 낮다'는 가설을 지지합니다.
")
} 
if (p_value_different < 0.05) {
  cat("5%의 유의 수준에서, '남성의 심박수가 평균과 다르다'는 가설을 지지합니다.
")
}

############ 해당 코드 설명 ###################

# 검정 통계량은 약 1.68입니다. 이는 샘플 평균이 모집단 평균과 얼마나 다른지를 표준 오차 단위로 표현한 것입니다. 이 값이 크면 클수록 샘플 평균이 모집단 평균과 더 크게 다르다는 것을 의미합니다.
# '남성의 심박수가 평균보다 높다'는 가설에 대한 p-value는 약 0.047입니다. 이는 5%의 유의 수준에서 귀무 가설을 기각하고 이 가설을 지지하게 만드는 값입니다. 즉, 샘플 데이터를 바탕으로 남성의 심박수가 국립보건원에서 제시한 평균보다 통계적으로 유의미하게 높다고 할 수 있습니다.
# '남성의 심박수가 평균보다 낮다'는 가설에 대한 p-value는 약 0.953입니다. 이는 5%의 유의 수준에서 귀무 가설을 기각할 수 없으므로, 이 가설을 지지할 수 없습니다. 즉, 샘플 데이터를 바탕으로 남성의 심박수가 국립보건원에서 제시한 평균보다 통계적으로 유의미하게 낮다고 할 수 없습니다.
# '남성의 심박수가 평균과 다르다'는 가설에 대한 p-value는 약 0.093입니다. 이는 5%의 유의 수준에서 귀무 가설을 기각할 수 없으므로, 이 가설을 지지할 수 없습니다. 즉, 샘플 데이터를 바탕으로 남성의 심박수가 국립보건원에서 제시한 평균과 통계적으로 유의미하게 다르다고 할 수 없습니다.
# 따라서, 이 분석을 통해 '남성의 심박수가 국립보건원에서 제시한 평균보다 높다'는 가설을 지지할 수 있습니다. 다시 말해, 샘플 데이터를 바탕으로 남성의 심박수가 국립보건원에서 제시한 평균보다 통계적으로 유의미하게 높다고 결론 내릴 수 있습니다.
