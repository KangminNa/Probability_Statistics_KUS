##################################
## 확률과 통계 과제             ##
## 고려대학교                   ##
## 서민석                       ##
## 2021270678 나강민 질문5      ##
##################################

## 라이브러리 및 저장소 설정
setRepositories(ind = 1:7)

# 패키지 설치
# install.packages("BSDA")

## 라이브러리 불러오기
library(devtools)
library(BSDA)

# 데이터 불러오기
data <- read.table("/Users/mac_nkm/Documents/GitHub/Probability_Statistics_KUS/HomeWork2/Data.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE) 

# z-test 수행
mu0 <- 96.0245  # 국민건강보험에서 조사한 휴식 SaO2 평균
sigma <- 8.995  # 국민건강보험에서 조사한 휴식 SaO2 표준편차
n <- nrow(data)  # 개체의 수
xbar <- mean(data$Resting_SaO2)  # 현재 로드된 데이터의 휴식 SaO2 평균
se <- sigma / sqrt(n)  # 표준 오차
z <- (xbar - mu0) / se  # 검정 통계량 계산

# p-value 계산
p_value <- 2 * pnorm(-abs(z))  # 귀무 가설과 대립 가설이 모두 '평균과 같다/다르다'로 설정되었으므로, 양측 검정을 수행합니다.

# 결과 출력
cat("검정 통계량:", z, "
")
cat("p-value:", p_value, "
")

# 5% 유의 수준에서 의사결정
if (p_value < 0.05) {
  cat("5%의 유의 수준에서, 귀무 가설을 기각하고 대립 가설을 선택합니다. 즉, 현재 로드된 데이터의 휴식 SaO2 평균이 국민건강보험에서 조사한 평균과 통계적으로 유의미하게 다릅니다.
")
} else {
  cat("5%의 유의 수준에서, 귀무 가설을 기각하지 않습니다. 즉, 현재 로드된 데이터의 휴식 SaO2 평균이 국민건강보험에서 조사한 평균과 통계적으로 유의미한 차이가 없습니다.
")
}

############ 해당 코드 설명 ###################

# 분석 결과에 따르면, 검정 통계량은 약 0.44이고 p-value는 약 0.66입니다. 여기서 유의 수준은 5%로 설정하였습니다.
# p-value가 유의 수준 0.05보다 크므로, 귀무 가설을 기각하지 않습니다. 이는 '현재 로드된 데이터의 휴식 SaO2 평균이 국민건강보험에서 조사한 평균과 통계적으로 유의미한 차이가 없다'는 결론을 내리게 됩니다.
# 즉, 이 결과는 현재 로드된 데이터의 휴식 SaO2 평균이 국민건강보험에서 조사한 평균과 크게 다르지 않다는 것을 의미합니다. 다시 말해, 현재 로드된 데이터는 휴식 SaO2 측면에서 국민건강보험에서 조사한 한국인 개체군을 잘 대표하고 있다고 볼 수 있습니다.
# 그러므로, 통계적으로 깔끔하게 올바른 결론은 '현재 로드된 데이터는 휴식 SaO2 측면에서 국민건강보험에서 조사한 한국인 개체군을 대표하는 독립적인 개체군이다'라고 할 수 있습니다. 이는 귀무 가설을 기각하지 않았기 때문에, 데이터가 국민건강보험에서 조사한 값과 통계적으로 유의미한 차이가 없다는 점을 기반으로 합니다.
